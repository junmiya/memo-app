# 🎴 かるたカード - React英単語学習アプリ開発手順書

## 📋 概要

React + TypeScript + Redux Toolkit を使用した英検4級英単語学習アプリ「かるたカード」の完全な開発手順書です。設計から実装、デプロイまでの全工程を詳細に記録しています。

## 🎯 プロジェクト仕様

### アプリケーション概要
- **名称**: かるたカード (英検4級英単語学習アプリ)
- **コンセプト**: 表裏2面のフラッシュカード形式での英単語学習
- **対象**: 英検4級受験者・中学生レベルの英語学習者
- **URL**: https://flipcards-eiken4.vercel.app

### 技術仕様
- **フロントエンド**: React 18, TypeScript
- **状態管理**: Redux Toolkit
- **スタイリング**: Tailwind CSS
- **ビルドツール**: Vite
- **デプロイ**: Vercel
- **ストレージ**: LocalStorage

### 主要機能
- 英単語フラッシュカード（表：英語、裏：日本語）
- 3Dカードフリップアニメーション
- リアルタイム検索・フィルタリング
- カテゴリ別カラーコーディング
- レスポンシブデザイン
- データ永続化

## 📚 Phase 1: 基盤構築

### Step 1.1: 要件定義・設計書作成

#### 要件分析
```markdown
# 実装された要件
- 2面構成メモカード（表裏フリップ機能）
- CRUD操作（作成・読込・更新・削除）
- 検索・フィルタリング機能
- ソート機能（作成日・更新日・アルファベット順）
- タグ機能
- カラーテーマ機能
- ローカルストレージ永続化
```

#### 設計書作成
```bash
# 作成された設計書
- メモサイト基本設計書.md
- ジュニア向けメモサイト設計書.md
- メモサイト実装プラン.md
- Phase1完了レポート.md
```

### Step 1.2: プロジェクト初期化

#### Vite + React + TypeScript セットアップ
```bash
# プロジェクト作成
npm create vite@latest memo-app --template react-ts
cd memo-app

# 依存関係インストール
npm install @reduxjs/toolkit react-redux react-router-dom
npm install -D tailwindcss postcss autoprefixer
npm install uuid @types/uuid

# Tailwind CSS初期化
npx tailwindcss init -p
```

#### プロジェクト構造設計
```
src/
├── components/          # UIコンポーネント
│   ├── layout/         # レイアウト関連
│   ├── memo/           # メモ機能
│   ├── search/         # 検索・フィルター
│   └── ui/             # 再利用可能UI
├── store/              # Redux状態管理
│   ├── slices/         # Redux slices
│   └── middleware/     # カスタムミドルウェア
├── types/              # TypeScript型定義
├── utils/              # ユーティリティ関数
└── hooks/              # カスタムhooks
```

### Step 1.3: TypeScript型定義

#### 基本型定義 (types/memo.ts)
```typescript
export interface Memo {
  id: string;
  frontContent: string;
  backContent: string;
  createdAt: Date;
  updatedAt: Date;
  tags?: string[];
  color?: string;
  isStarred?: boolean;
}

export interface MemoState {
  items: Memo[];
  totalCount: number;
  currentPage: number;
  itemsPerPage: number;
  isLoading: boolean;
  error: string | null;
}

export interface UIState {
  selectedMemoId: string | null;
  isEditMode: boolean;
  searchQuery: string;
  sortBy: 'createdAt' | 'updatedAt' | 'alphabetical';
  sortOrder: 'asc' | 'desc';
  isFormOpen: boolean;
  filters: FilterState;
}
```

### Step 1.4: Redux Store設定

#### Store構成 (store/index.ts)
```typescript
import { configureStore } from '@reduxjs/toolkit';
import memoReducer from './slices/memoSlice';
import uiReducer from './slices/uiSlice';
import { localStorageMiddleware } from './middleware/localStorage';

export const store = configureStore({
  reducer: {
    memos: memoReducer,
    ui: uiReducer,
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware({
      serializableCheck: {
        ignoredActions: ['memos/addMemo', 'memos/updateMemo', 'memos/setMemos'],
        ignoredPaths: ['memos.items'],
      },
    }).concat(localStorageMiddleware),
  devTools: process.env.NODE_ENV !== 'production',
});
```

#### Memo Slice実装
```typescript
const memoSlice = createSlice({
  name: 'memos',
  initialState,
  reducers: {
    addMemo: (state, action: PayloadAction<Memo>) => {
      state.items.unshift(action.payload);
      state.totalCount += 1;
    },
    updateMemo: (state, action: PayloadAction<Memo>) => {
      const index = state.items.findIndex(memo => memo.id === action.payload.id);
      if (index !== -1) {
        state.items[index] = action.payload;
      }
    },
    deleteMemo: (state, action: PayloadAction<string>) => {
      state.items = state.items.filter(memo => memo.id !== action.payload);
      state.totalCount -= 1;
    },
    setMemos: (state, action: PayloadAction<Memo[]>) => {
      state.items = action.payload;
      state.totalCount = action.payload.length;
    },
  },
});
```

### Step 1.5: UI Components実装

#### Header Component
```typescript
const Header: React.FC<HeaderProps> = ({ onCreateMemo, memoCount = 0 }) => {
  return (
    <header className="bg-white shadow-sm border-b border-gray-200">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">
          <h1 className="text-2xl font-bold text-gray-900 flex items-center">
            <span className="mr-2">🎴</span>
            かるたカード
          </h1>
          <Button onClick={onCreateMemo} variant="primary" size="md">
            新しいカード
          </Button>
        </div>
      </div>
    </header>
  );
};
```

#### MemoCard Component（カードフリップ実装）
```typescript
const MemoCard: React.FC<MemoCardProps> = ({ memo, onEdit, onDelete }) => {
  const [isFlipped, setIsFlipped] = useState(false);
  
  return (
    <div className="memo-card-container perspective-1000 h-48 cursor-pointer group">
      <div className={`memo-card transform-style-preserve-3d transition-transform duration-600 ${
        isFlipped ? 'rotate-y-180' : ''
      }`} onClick={() => setIsFlipped(!isFlipped)}>
        {/* 表面 - 英語 */}
        <div className="card-face absolute w-full h-full backface-hidden">
          <div className="text-4xl font-bold text-center">
            {memo.frontContent}
          </div>
        </div>
        
        {/* 裏面 - 日本語 */}
        <div className="card-face absolute w-full h-full backface-hidden rotate-y-180">
          <div className="text-3xl font-bold text-center">
            {memo.backContent}
          </div>
        </div>
      </div>
    </div>
  );
};
```

### Step 1.6: LocalStorage実装

#### Storage Manager
```typescript
export class LocalStorageManager {
  static save(memos: Memo[]): void {
    try {
      const data = {
        memos,
        lastUpdated: new Date().toISOString(),
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    } catch (error) {
      console.error('Failed to save to localStorage:', error);
    }
  }

  static load(): Memo[] {
    try {
      const data = localStorage.getItem(STORAGE_KEY);
      if (!data) return [];
      
      const parsed = JSON.parse(data);
      return parsed.memos || [];
    } catch (error) {
      console.error('Failed to load from localStorage:', error);
      return [];
    }
  }
}
```

#### Redux Middleware
```typescript
export const localStorageMiddleware: Middleware = (store) => (next) => (action: any) => {
  const result = next(action);
  
  if (action.type.startsWith('memos/')) {
    const state = store.getState();
    const memosToSave = state.memos.items.map((memo: any) => ({
      ...memo,
      createdAt: memo.createdAt instanceof Date ? memo.createdAt.toISOString() : memo.createdAt,
      updatedAt: memo.updatedAt instanceof Date ? memo.updatedAt.toISOString() : memo.updatedAt,
    }));
    
    LocalStorageManager.save(memosToSave);
  }
  
  return result;
};
```

## 🔍 Phase 2: 検索・フィルタリング機能

### Step 2.1: 検索機能実装

#### SearchBar Component
```typescript
const SearchBar: React.FC<SearchBarProps> = ({ placeholder = "カードを検索..." }) => {
  const [localQuery, setLocalQuery] = useState(searchQuery);
  const debounceTimeoutRef = useRef<NodeJS.Timeout>();

  // デバウンス機能付き検索（300ms）
  useEffect(() => {
    if (debounceTimeoutRef.current) {
      clearTimeout(debounceTimeoutRef.current);
    }

    debounceTimeoutRef.current = setTimeout(() => {
      dispatch(setSearchQuery(localQuery));
    }, 300);

    return () => {
      if (debounceTimeoutRef.current) {
        clearTimeout(debounceTimeoutRef.current);
      }
    };
  }, [localQuery, dispatch]);
};
```

### Step 2.2: フィルタリング機能実装

#### FilterState型定義
```typescript
export interface FilterState {
  tags: string[];
  colors: string[];
  isStarred: boolean | null;
  dateRange: {
    start: Date | null;
    end: Date | null;
  };
}
```

#### FilterPanel Component
```typescript
const FilterPanel: React.FC<FilterPanelProps> = ({ className, isCollapsed, onToggleCollapse }) => {
  const [filters, setLocalFilters] = useState<FilterState>(currentFilters);
  
  const handleApplyFilters = () => {
    dispatch(setFilters(filters));
  };
  
  return (
    <div className="bg-white rounded-lg shadow-sm border">
      {/* タグフィルター */}
      <div className="flex flex-wrap gap-2">
        {availableTags.map(tag => (
          <button
            key={tag}
            onClick={() => handleTagToggle(tag)}
            className={`px-3 py-1 rounded-full text-sm font-medium ${
              filters.tags.includes(tag)
                ? 'bg-blue-100 text-blue-800 border border-blue-300'
                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
            }`}
          >
            #{tag}
          </button>
        ))}
      </div>
    </div>
  );
};
```

### Step 2.3: 高度なセレクター実装

#### Reselect使用したセレクター
```typescript
export const selectSortedAndFilteredMemos = createSelector(
  [selectFilteredMemos, selectSortBy, selectSortOrder],
  (filteredMemos, sortBy, sortOrder) => {
    const sortedMemos = [...filteredMemos];

    sortedMemos.sort((a, b) => {
      let comparison = 0;
      
      switch (sortBy) {
        case 'createdAt':
          comparison = new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime();
          break;
        case 'updatedAt':
          comparison = new Date(a.updatedAt).getTime() - new Date(b.updatedAt).getTime();
          break;
        case 'alphabetical':
          comparison = a.frontContent.localeCompare(b.frontContent);
          break;
      }
      
      return sortOrder === 'asc' ? comparison : -comparison;
    });

    return sortedMemos;
  }
);
```

## 📚 Phase 3: 英検4級コンテンツ追加

### Step 3.1: サンプルデータ設計

#### 英検4級単語データ構造
```typescript
export const eiken4SampleData: Omit<Memo, 'id' | 'createdAt' | 'updatedAt'>[] = [
  // 基本動詞（青色）
  { frontContent: 'have', backContent: '持つ、食べる', tags: ['英検4級', '動詞'], color: 'blue' },
  { frontContent: 'make', backContent: '作る', tags: ['英検4級', '動詞'], color: 'blue' },
  
  // 日常生活（緑色）
  { frontContent: 'family', backContent: '家族', tags: ['英検4級', '名詞'], color: 'green' },
  { frontContent: 'school', backContent: '学校', tags: ['英検4級', '名詞'], color: 'green' },
  
  // 形容詞（黄色）
  { frontContent: 'good', backContent: '良い', tags: ['英検4級', '形容詞'], color: 'yellow' },
  { frontContent: 'big', backContent: '大きい', tags: ['英検4級', '形容詞'], color: 'yellow' },
];
```

### Step 3.2: 自動初期化実装

#### サンプルデータ初期化
```typescript
export const initializeSampleData = (): void => {
  if (!hasSampleData()) {
    const sampleMemos = createSampleMemos();
    
    try {
      const data = {
        memos: sampleMemos,
        totalCount: sampleMemos.length,
        timestamp: new Date().toISOString(),
      };
      localStorage.setItem('memo-app-data', JSON.stringify(data));
      console.log('英検4級サンプルデータを初期化しました:', sampleMemos.length, '件');
    } catch (error) {
      console.error('サンプルデータの初期化に失敗しました:', error);
    }
  }
};
```

#### useMemos hookへの統合
```typescript
const loadMemos = useCallback(async () => {
  try {
    dispatch(setLoading(true));
    
    // サンプルデータを初期化（初回のみ）
    initializeSampleData();
    
    const savedMemos = LocalStorageManager.load();
    dispatch(setMemos(savedMemos));
  } catch (error) {
    dispatch(setError('メモの読み込みに失敗しました'));
    console.error('Failed to load memos:', error);
  }
}, [dispatch]);
```

## 🎨 Phase 4: UI/UX改善

### Step 4.1: カードデザイン最適化

#### 学習に最適化したレイアウト
```typescript
// 表面 - 英語（大きく中央配置）
<div className="flex-1 flex items-center justify-center">
  <div className="text-4xl font-bold text-center leading-tight">
    {memo.frontContent}
  </div>
</div>

// 裏面 - 日本語（大きく中央配置）
<div className="flex-1 flex items-center justify-center">
  <div className="text-3xl font-bold text-center leading-tight">
    {memo.backContent}
  </div>
</div>
```

### Step 4.2: レスポンシブデザイン

#### Tailwind CSSを使用したレスポンシブ対応
```css
/* グリッドレイアウト */
.grid {
  @apply grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6;
}

/* フォントサイズ調整 */
.card-text {
  @apply text-2xl sm:text-3xl lg:text-4xl;
}
```

### Step 4.3: アニメーション実装

#### 3D CSS Transform
```css
.memo-card-container {
  perspective: 1000px;
}

.memo-card {
  transform-style: preserve-3d;
  transition: transform 0.6s ease;
}

.memo-card.flipped {
  transform: rotateY(180deg);
}

.card-face {
  backface-visibility: hidden;
  position: absolute;
}

.back {
  transform: rotateY(180deg);
}
```

## 🚀 Phase 5: デプロイ・リブランディング

### Step 5.1: Vercel設定

#### vercel.json設定
```json
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

### Step 5.2: GitHub連携

#### リポジトリ作成・設定
```bash
# GitHub CLIでリポジトリ作成
gh repo create memo-app --public --description "React + TypeScript + Redux Toolkit 2面構成メモカードアプリ"

# Git設定
git remote add origin https://github.com/junmiya/memo-app.git
git branch -M main
git push -u origin main
```

### Step 5.3: サイトリブランディング

#### 「メモアプリ」→「かるたカード」
```typescript
// Header.tsx
<h1 className="text-2xl font-bold text-gray-900 flex items-center">
  <span className="mr-2">🎴</span>
  かるたカード
</h1>

// index.html
<title>🎴 かるたカード</title>

// 各種UI文言変更
- "新しいメモ" → "新しいカード"
- "メモ一覧" → "カード一覧"
- "メモを検索" → "カードを検索"
```

## 🧪 テスト・品質管理

### Step 6.1: ビルドテスト

#### TypeScript型チェック
```bash
# ビルドコマンド
npm run build

# エラー対応例
- 未使用import削除
- 型注釈追加
- any型の適切な型定義
```

### Step 6.2: 動作確認

#### 確認項目チェックリスト
- ✅ カード作成・編集・削除機能
- ✅ カードフリップアニメーション
- ✅ 検索機能（英語・日本語）
- ✅ フィルタリング（タグ・色・お気に入り）
- ✅ ソート機能（3種類）
- ✅ レスポンシブデザイン
- ✅ LocalStorage永続化
- ✅ エラーハンドリング

### Step 6.3: パフォーマンス最適化

#### Lighthouse目標スコア
- Performance: 90+
- Accessibility: 95+
- Best Practices: 90+
- SEO: 85+

## 📊 開発メトリクス

### コード統計
- **総ファイル数**: 82モジュール
- **TypeScriptファイル**: 25個
- **コンポーネント数**: 15個
- **Redux Slice数**: 2個
- **カスタムHook数**: 3個

### バンドルサイズ
- **CSS**: 24.57 kB (gzip: 4.89 kB)
- **JavaScript**: 209.84 kB (gzip: 66.55 kB)
- **HTML**: 0.46 kB (gzip: 0.33 kB)

### 機能実装状況
- **Phase 1** (基本機能): ✅ 完了
- **Phase 2** (検索・フィルター): ✅ 完了
- **Phase 3** (英単語コンテンツ): ✅ 完了
- **Phase 4** (UI/UX改善): ✅ 完了
- **Phase 5** (デプロイ・リブランディング): ✅ 完了

## 🔧 開発環境・ツール

### 必須ツール
```bash
# Node.js環境
node: v20+
npm: 最新版

# Git & GitHub
git: 最新版
gh: GitHub CLI

# エディタ
VS Code (推奨)
- ESLint extension
- Prettier extension
- TypeScript extension
- Tailwind CSS IntelliSense
```

### 開発コマンド
```bash
# 開発サーバー起動
npm run dev

# プロダクションビルド
npm run build

# プレビュー
npm run preview

# 型チェック
npx tsc --noEmit

# デプロイ
git push origin main  # Vercel自動デプロイ
```

## 🚨 トラブルシューティング

### よくある問題と解決策

#### 1. TypeScriptビルドエラー
```bash
# 症状: 型エラーでビルド失敗
# 解決: 適切な型注釈追加
const memos = useAppSelector(selectMemos) as Memo[];
```

#### 2. LocalStorageエラー
```bash
# 症状: データが保存されない
# 解決: try-catchでエラーハンドリング
try {
  localStorage.setItem(key, value);
} catch (error) {
  console.error('Storage error:', error);
}
```

#### 3. カードフリップアニメーション問題
```css
/* 症状: アニメーションが動作しない */
/* 解決: CSS設定確認 */
.memo-card-container {
  perspective: 1000px; /* 必須 */
}
.memo-card {
  transform-style: preserve-3d; /* 必須 */
}
```

#### 4. レスポンシブデザイン問題
```css
/* 症状: モバイルで表示崩れ */
/* 解決: Tailwindブレークポイント活用 */
<div className="text-2xl sm:text-3xl lg:text-4xl">
```

## 📚 学習リソース・参考資料

### 技術スタック学習
- **React**: [React公式ドキュメント](https://react.dev/)
- **TypeScript**: [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- **Redux Toolkit**: [RTK公式ガイド](https://redux-toolkit.js.org/)
- **Tailwind CSS**: [Tailwind公式ドキュメント](https://tailwindcss.com/docs)
- **Vite**: [Vite公式ガイド](https://vitejs.dev/guide/)

### 設計パターン
- **コンポーネント設計**: Atomic Design
- **状態管理**: Redux Pattern
- **CSS設計**: Utility-First CSS
- **TypeScript**: Strict Type Checking

## 🎯 今後の拡張予定

### Phase 6: 高度な機能（予定）
- **Firebase統合**: リアルタイム同期
- **認証機能**: ユーザーアカウント
- **学習進捗管理**: 習熟度トラッキング
- **音声機能**: 発音練習
- **PWA対応**: オフライン学習

### Phase 7: 機能拡張（予定）
- **他の級対応**: 英検3級・5級
- **カスタム単語**: ユーザー定義単語
- **学習統計**: 詳細な分析機能
- **ソーシャル機能**: 学習の共有

## 📝 開発記録

### 主要マイルストーン
1. **2025-01-11**: プロジェクト開始・Phase 1完了
2. **2025-01-11**: Phase 2（検索・フィルター）完了
3. **2025-01-11**: 英検4級データ追加・Phase 3完了
4. **2025-01-11**: UI改善・Phase 4完了
5. **2025-01-11**: デプロイ・リブランディング・Phase 5完了

### Git履歴
- **53 files**: 初回コミット（Phase 1）
- **3 files**: サンプルデータ追加
- **1 file**: UI改善
- **9 files**: リブランディング
- **1 file**: デプロイ手順書
- **1 file**: 開発手順書（本書）

## 🔗 関連ドキュメント

- **設計書**: メモサイト基本設計書.md
- **実装プラン**: メモサイト実装プラン.md
- **完了レポート**: Phase1完了レポート.md
- **デプロイガイド**: デプロイ手順書.md
- **本番サイト**: https://flipcards-eiken4.vercel.app
- **リポジトリ**: https://github.com/junmiya/memo-app

---

**作成日**: 2025-01-11  
**最終更新**: 2025-01-11  
**作成者**: Claude Code Assistant  
**対象**: React英単語学習アプリ「かるたカード」  
**総開発時間**: 約4時間  
**実装フェーズ**: Phase 1-5 完了